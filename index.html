<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Intro - Spaces</title>
		<link rel="SHORTCUT ICON" href="/favicon.ico" type="image/x-icon">
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<link rel="stylesheet" href="res/jquery.scrollbar.style.css" />
		<link rel="stylesheet" href="res/jquery.scrollbar.css" />
		<style>
			
			body {
				background:#000;
				color:#fff;
				padding:0;
				margin:0;
			}
			.navbar {
				height: 64px;
				position: sticky;
				top: 0;
				background: #777;
				box-shadow: 0px -1px 14px 3px #000000;
			}
			section#home{
				display: block;	
			}			
			section#more{
			    display: block;
			    height: 300px;
			    text-align: center;
			    background: #F05222;
			}
			section#projects{
			    display: block;
			    height: 300px;
			    text-align: center;
			    background: #7CBA01;
			}
			section#about{
			    display: block;
			    height: 300px;
			    text-align: center;
			    background: #00A6F0;
			}
			section#contacts{
			    display: block;
			    height: 650px;
			    text-align: center;
			    background: #FFB901;
			}
			nav{
			    position: fixed;
			    z-index: 10;
			    right:-8px;
			    top: 0px;
			    padding: 20px;
			    background: #77000000;
			    -webkit-transition: top 0.8s ease;
			}
			a{
			    display: block;
			    font: 24px/24px sans-serif;
			    text-decoration: none;
			    pointer-events:none;
			    color: #fff;
			    opacity: 0.0;
			    -webkit-transition: opacity 0.8s ease;
			}
			a.active{
			  opacity: 0.8;
			}
		</style>
		
		<script src="js/jquery-3.3.1.min.js"></script>
		<script
			src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
			integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU="
			crossorigin="anonymous">
		</script>
		<script src="js/jquery.scrollbar.min.js"></script>
		
		
		
		<script>
			var isScrolling = false;
			
			/*jQuery(document).ready(function(){
				jQuery('.scrollbar-macosx').scrollbar();
			});*/
			
			// при загрузке страницы инициализируем скроллбар и плавно смещаемся в самый верх
			$(window).on("load", function () {
				$('.scrollbar-macosx').scrollbar(); // инициализируем кастомный скроллбар
				$('nav').css( 'top', '0px' );
				var top = $('#home').offset().top;
				animateToScroll(top, 1500, "easeOutQuart");
				$('a.active').removeClass('active');
				$('a[href="#'+'home'+'"]').addClass('active');				
			});			

			// показывает инфо-статус текущего якоря с анимированным переходом
			$(window).scroll(function() {
				$('section').each(function(i,el) {
					var top  = $(el).offset().top-100;
					var bottom = top +$(el).height();
					var scroll = $(window).scrollTop();
					var id = $(el).attr('id');
					if( scroll > top && scroll < bottom){
						$('a.active').removeClass('active');
						$('a[href="#'+id+'"]').addClass('active');
						var delta = 0 - (getId(id) - 1) * 24;
						var top_delta = String(delta) + 'px';
						$('nav').css( 'top', top_delta );					
					}

					function getId(id_name) {
						var result;
						switch (id_name) {
							case 'home': result = 1; break;
							case 'more': result = 2; break;
							case 'projects': result = 3; break;
							case 'about': result = 4; break;
							case 'contacts': result = 5; break;
						}
						return result;
					}
				})
			});			
			
			// плавный скролл страницы со смещением в 300 px и временем анимации 500 ms
			$(window).on('mousewheel DOMMouseScroll', function(e) {
				var event = e.originalEvent, delta = 0;				
				delta = (event.detail) ? event.detail * -40 : event.wheelDelta;
				console.log('is scrolling!');
				if (delta !== undefined) {
					var delta_top = (delta < 0) ? -300 : 300;
					var top = $('html, body').scrollTop() - delta_top;
					e.preventDefault();
					animateToScroll(top, 500, "easeOutCubic");
				}				
			});

			// якорный переход к контенту по клику navbar-а
			/*$("navbar").on("click","a", function (event) {
				event.preventDefault(); 
				var id  = $(this).attr('href');
				top = $(id).offset().top;
				animateToScroll(top, 1500, "easeOutQuart");
			});*/
			
			// анимация скролла (параметры - смещение скролла на..., время анимации, тип анимации)
			function animateToScroll(position, time, animation) {
				if (!isScrolling) {
					isScrolling = true;
					$('html, body').animate({
							scrollTop: position
						}, {
							duration: time,
							specialEasing: { scrollTop: animation },
							complete: function() { isScrolling = false; }
						}
					);
				}
			}
		</script>		
		<script src="js/three.min.js"></script>
		<script src="js/CopyShaderMin.js"></script>		
		<script src="js/DigitalGlitchMin.js"></script>
		<script src="js/EffectComposerMin.js"></script>
		<script src="js/ShaderPassMin.js"></script>
		<script src="js/TexturePassMin.js"></script>
		<script src="js/GlitchPassMin.js"></script>
	</head>
	<body>
		<div class="wrapper scrollbar-macosx">	
			<nav>
			    <a href="#home"> Home <img src="res/ic-home-min.png"></a>
			    <a href="#more"> More <img src="res/ic-more-min.png"></a>
			    <a href="#projects"> Projects <img src="res/ic-projects-min.png"></a>
			    <a href="#about"> About <img src="res/ic-about-min.png"></a>
			    <a href="#contacts"> Contacts <img src="res/ic-contacts-min.png"></a>
			</nav>
			<div style="font-size:0;">
			    <section id ="home"></section>
			    <div class="navbar"></div>
			    <section id ="more"> More Info </section>
			    <section id ="projects"> Provide Services for Projects </section>
			    <section id ="about"> About Us </section>
			    <section id ="contacts"> Contacts </section>
			<div>
		</div>
		<script src="js/intro/frame.js"></script>
	</body>
</html>
